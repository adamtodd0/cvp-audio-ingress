parameters:
  - name: hookUrl
    type: string
  - name: title
    type: string
  - name: message
    type: string
  - name: emojiIcon
    type: string
    default: ':speech_balloon:'
    values:
      - ':heavy_exclamation_mark:'
      - ':bangbang:'
      - ':white_check_mark:'
      - ':sos:'
      - ':speech_balloon:'
  - name: conditionAction
    type: string
    default: 'true'

steps:
  - powershell: | 
      Write-Host "Sending slack message for BUILD: $($env:BUILD_BUILDID)"

      $Url = "${{parameters.hookUrl}}"
      $body= @"
        {
            "pretext": "${{parameters.title}}",
            "text": "${{parameters.message}}",
            "icon_emoji":"${{parameters.emojiIcon}}"
        }"@

      Invoke-WebRequest -Method Post -Uri $Url -Body $body -ContentType 'application/json'
      Write-Host "Message has been sent"
    displayName: 'Send Slack Message'
    condition: eq(parameters.conditionAction, 'true')