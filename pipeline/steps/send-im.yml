parameters:
  - name: hookUrl
    type: string
  - name: title
    type: string
  - name: message
    type: string
  - name: emojiIcon
    type: string
    default: ':speech_balloon:'
    values:
      - ':heavy_exclamation_mark:'
      - ':bangbang:'
      - ':white_check_mark:'
      - ':sos:'
      - ':speech_balloon:'
  - name: conditionAction
    type: string
    default: 'true'

steps:
  - powershell: | 
      $verrepo = "${{ parameters.conditionAction }}"
      Write-Host "I got $verrepo"

      Write-Host "Sending slack message"

      $url = "${{parameters.hookUrl}}"
      $title = "${{parameters.title}}"
      $message = "${{parameters.message}}"
      $emojiIcon = "${{parameters.emojiIcon}}"

      $body= 
        {
            pretext= "$title",
            text= "$message",
            icon_emoji="$emojiIcon"
        }

      Invoke-WebRequest -Method Post -Uri $url -Body ($body | ConvertTo-Json) -ContentType 'application/json'
      Write-Host "Message has been sent"
    displayName: 'Send Slack Message'
    #condition: eq(${{ parameters.conditionAction }}, 'true')