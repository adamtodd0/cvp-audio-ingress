parameters:
  - name: planOrStateFilePath
    type: string
  - name: outputLocation
    type: string

steps:

  - template: tf-init.yaml
    parameters:
      useBackend: true

  - task: TerraformCLI@0
    inputs:
      command: 'show'
      workingDirectory: '$(System.DefaultWorkingDirectory)'
      commandOptions: '-json -no-color'
      allowTelemetryCollection: true
      inputTargetPlanOrStateFilePath: '${{parameters.planOrStateFilePath}} > $outputlocation'

  #- powershell: |
  #    $outputlocation = "${{parameters.outputLocation}}"
  #    if ($outputlocation -eq "") {
  #      terraform show ${{parameters.planOrStateFilePath}}
  #    } else {
  #      terraform show -json -no-color ${{parameters.planOrStateFilePath}} > $outputlocation
 #     }